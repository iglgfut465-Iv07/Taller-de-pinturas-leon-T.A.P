<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>TALLER DE ARTE LEON</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
    margin:0;
    font-family:'Segoe UI',sans-serif;
    background:#121212;
    color:#fff;
}

/* HEADER */
header{
    text-align:center;
    padding:30px 20px;
    background: linear-gradient(135deg,#ff6f61,#de425b);
    border-radius:0 0 50px 50px;
}
header img{
    max-width:120px;
    border-radius:50%;
    border:3px solid #fff;
}
header h1{margin:5px 0;font-size:2.2em;}

/* ICONO AJUSTES */
#iconoAjustes{
    position: fixed;
    top:20px;
    right:20px;
    cursor:pointer;
    z-index:1000;
}
#iconoAjustes span{
    display:block;
    width:35px;
    height:5px;
    background:#ff9800;
    margin:5px 0;
    border-radius:5px;
}

/* PANEL AJUSTES */
#panelAjustes{
    position:fixed;
    top:60px;
    right:20px;
    background:#1e1e1e;
    padding:20px;
    border-radius:20px;
    width:320px;
    max-height:80vh;
    overflow-y:auto;
    display:none;
    z-index:1000;
}
#panelAjustes input, #panelAjustes select{
    width:100%;
    margin-bottom:10px;
    padding:8px;
    border-radius:10px;
    border:none;
}
#panelAjustes button{
    width:100%;
    padding:10px;
    border:none;
    border-radius:25px;
    background:#25d366;
    color:#fff;
    font-weight:bold;
    margin-bottom:10px;
}
#cerrarPanel{
    background:red;
    width:30px;
    height:30px;
    border-radius:50%;
    float:right;
}

/* GALERIA */
.galeria{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
    gap:20px;
}
.cuadro{
    position:relative;
    border-radius:20px;
    overflow:hidden;
}
.cuadro img{
    width:100%;
    display:block;
    user-select:none;
    -webkit-user-drag:none;
}
.cuadro p{
    text-align:center;
    background:#121212;
    margin:0;
    padding:10px;
}

/* MARCA DE AGUA */
.marca-agua{
    position:absolute;
    background:rgba(0,0,0,0.4);
    color:#fff;
    padding:4px 8px;
    border-radius:8px;
    pointer-events:none;
    text-shadow:0 0 5px #000;
}

/* POSICIONES */
.marca-agua.top-left{top:10px;left:10px;}
.marca-agua.top-right{top:10px;right:10px;}
.marca-agua.bottom-left{bottom:10px;left:10px;}
.marca-agua.bottom-right{bottom:10px;right:10px;}
.marca-agua.center{
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
}

/* PANTALLA EMERGENTE */
#pantallaEmergente{
    display:none;
    position:fixed;
    inset:0;
    background:rgba(0,0,0,0.9);
    justify-content:center;
    align-items:center;
    z-index:2000;
}
#pantallaEmergente img{
    max-width:90%;
    max-height:80%;
}
#cerrarEmergente{
    position:absolute;
    top:20px;
    right:30px;
    font-size:30px;
    cursor:pointer;
}
</style>
</head>

<body>

<header>
    <img id="logo">
    <h1 id="nombreSitio">TALLER DE ARTE LEON</h1>
</header>

<div id="iconoAjustes" onclick="abrirPanelAdmin()">
    <span></span><span></span><span></span>
</div>

<div id="panelAjustes">
    <button id="cerrarPanel" onclick="cerrarPanel()">✖</button>
    <h3>Administrador</h3>

    <input type="text" id="nuevoNombre" placeholder="Nuevo nombre">
    <button onclick="cambiarNombre()">Actualizar Nombre</button>

    <input type="file" id="nuevoLogo" accept="image/*">
    <button onclick="cambiarLogo()">Actualizar Logo</button>

    <input type="file" id="nuevoCuadro" accept="image/*">
    <input type="number" id="precioCuadro" placeholder="Precio">
    <button onclick="subirCuadro()">Agregar Cuadro</button>

    <select id="cuadrosEliminar"></select>
    <button onclick="eliminarCuadro()">Eliminar Cuadro</button>

    <h4>Marca de Agua</h4>
    <input type="text" id="textoMarcaAgua" placeholder="Firma o marca">

    <label><input type="checkbox" id="activarMarca"> Activar marca</label>

    <select id="posicionMarca">
        <option value="bottom-right">Abajo derecha</option>
        <option value="bottom-left">Abajo izquierda</option>
        <option value="top-right">Arriba derecha</option>
        <option value="top-left">Arriba izquierda</option>
        <option value="center">Centro</option>
    </select>

    <label>Tamaño</label>
    <input type="range" id="tamanoMarca" min="10" max="30">

    <label>Opacidad</label>
    <input type="range" id="opacidadMarca" min="0.1" max="1" step="0.1">

    <button onclick="guardarMarcaAgua()">Guardar Marca de Agua</button>
</div>

<section>
    <h2>Cuadros en Venta</h2>
    <div class="galeria" id="galeria"></div>
</section>

<div id="pantallaEmergente">
    <span id="cerrarEmergente">✖</span>
    <img id="imagenEmergente">
</div>

<script>
const PASSWORD="admin123";

let marcaAgua = localStorage.getItem("marcaAgua") || "© Taller de Arte León";
let configMarca = JSON.parse(localStorage.getItem("configMarca")) || {
    activa:true,
    posicion:"bottom-right",
    tamano:13,
    opacidad:0.4
};

let cuadros = JSON.parse(localStorage.getItem("cuadros")) || [];

function mostrarGaleria(){
    const g=galeria;
    const s=cuadrosEliminar;
    g.innerHTML="";
    s.innerHTML="";
    cuadros.forEach((c,i)=>{
        g.innerHTML+=`
        <div class="cuadro">
            <img src="${c.img}" onclick="abrirEmergente('${c.img}')" oncontextmenu="return false">
            ${configMarca.activa ? `
            <div class="marca-agua ${configMarca.posicion}"
            style="font-size:${configMarca.tamano}px;opacity:${configMarca.opacidad};">
            ${marcaAgua}
            </div>` : ""}
            <p>${c.precio}</p>
        </div>`;
        s.innerHTML+=`<option value="${i}">Cuadro ${i+1}</option>`;
    });
    localStorage.setItem("cuadros",JSON.stringify(cuadros));
}

function guardarMarcaAgua(){
    marcaAgua = textoMarcaAgua.value.trim() || marcaAgua;
    configMarca = {
        activa: activarMarca.checked,
        posicion: posicionMarca.value,
        tamano: tamanoMarca.value,
        opacidad: opacidadMarca.value
    };
    localStorage.setItem("marcaAgua",marcaAgua);
    localStorage.setItem("configMarca",JSON.stringify(configMarca));
    mostrarGaleria();
}

function abrirPanelAdmin(){
    if(prompt("Contraseña:")===PASSWORD)
        panelAjustes.style.display="block";
}
function cerrarPanel(){panelAjustes.style.display="none";}

function subirCuadro(){
    const f=nuevoCuadro.files[0];
    if(!f) return;
    const r=new FileReader();
    r.onload=()=>{cuadros.push({img:r.result,precio:"$"+precioCuadro.value});mostrarGaleria();}
    r.readAsDataURL(f);
}

function eliminarCuadro(){
    cuadros.splice(cuadrosEliminar.value,1);
    mostrarGaleria();
}

function abrirEmergente(src){
    imagenEmergente.src=src;
    pantallaEmergente.style.display="flex";
}
cerrarEmergente.onclick=()=>pantallaEmergente.style.display="none";

/* CARGAR AJUSTES */
textoMarcaAgua.value = marcaAgua;
activarMarca.checked = configMarca.activa;
posicionMarca.value = configMarca.posicion;
tamanoMarca.value = configMarca.tamano;
opacidadMarca.value = configMarca.opacidad;

mostrarGaleria();
</script>

</body>
</html>
